<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>摄影 - 修改信息</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->
  <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,600;1,700&family=Inter:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&family=Cardo:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">
  <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="assets/vendor/aos/aos.css" rel="stylesheet">

  <!-- Template Main CSS File -->
  <link href="assets/css/main.css" rel="stylesheet">

</head>

<body>

  <!-- ======= Header ======= -->
  <header id="header" class="header d-flex align-items-center fixed-top">
    <div class="container-fluid d-flex align-items-center justify-content-between">

      <a href="/" class="logo d-flex align-items-center  me-auto me-lg-0">
        <!-- Uncomment the line below if you also wish to use an image logo -->
        <!-- <img src="assets/img/logo.png" alt=""> -->
        <i class="bi bi-camera"></i>
        <h1>摄影</h1>
      </a>

      <nav id="navbar" class="navbar">
        <ul>
          <li><a href="/">主页</a></li>
          <li class="dropdown"><a href="#"><span>画廊</span> <i class="bi bi-chevron-down dropdown-indicator"></i></a>
            <ul>
              <li><a href="/gallery?label=动物">动物</a></li>
              <li><a href="/gallery?label=人">朋友</a></li>
              <li><a href="/gallery?label=自然界">自然</a></li>
              <li><a href="/gallery?label=建筑">建筑</a></li>
              <li><a href="/gallery?label=壁纸">壁纸</a></li>
              <li><a href="/gallery?label=旅行">旅行</a></li>
              <li><a href="/gallery?label=体育">体育</a></li>
              <li><a href="/gallery?label=时尚">时尚</a></li>
              <li><a href="/gallery?label=旅游">旅游</a></li>
              <li><a href="/gallery?label=电影">电影</a></li>
            </ul>
          </li>
          <li><a href="/author">摄影师</a></li>
          <li><a href="/creation">创作</a></li>
          <li><a href="/contact">联系</a></li>
          <li class="dropdown"><a href="#" class="active"><span>我的</span><i class="bi bi-chevron-down dropdown-indicator"></i></a>
            <ul>
              <li><a href="/mine" id="mine">我的信息</a></li>
              <li><a href="/modify" class="active" id="modify">修改信息</a></li>
              <li><a href="/login" id="loginLink">登录</a></li>
              <li><a href="/login" id="logoutLink">注销</a></li>
            </ul>
          </li>
          <li style="margin-left: 25px;">
            <form action="/search" method="GET">
              <div class="input-group input-group-sm mb-3" style="margin-top: 15px">
                <input type="text" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-sm" name="search" required>
                <button class="btn btn-outline-secondary" type="submit" id="button-addon2">搜索</button>
              </div>
            </form>
          </li>
        </ul>
      </nav><!-- .navbar -->

      <div class="header-social-links">
        <a href="#" class="twitter"><i class="bi bi-twitter"></i></a>
        <a href="#" class="facebook"><i class="bi bi-facebook"></i></a>
        <a href="#" class="instagram"><i class="bi bi-instagram"></i></a>
        <a href="#" class="linkedin"><i class="bi bi-linkedin"></i></a>
      </div>
      <i class="mobile-nav-toggle mobile-nav-show bi bi-list"></i>
      <i class="mobile-nav-toggle mobile-nav-hide d-none bi bi-x"></i>

    </div>
  </header><!-- End Header -->

  <main id="main" data-aos="fade" data-aos-delay="1500">

    <!-- ======= End Page Header ======= -->
    <div class="page-header d-flex align-items-center">
      <div class="container position-relative">
        <div class="row d-flex justify-content-center">
          <div class="col-lg-6 text-center">
            <h3>修改信息！</h3>
            <p>为确保账号的安全与及时沟通，我们强烈建议您定期检查并更新您的账号信息。保持账号信息的准确性不仅有助于我们更好地为您提供服务，也是确保账号安全的关键。</p>
            <p>为了确保您在我们平台上的使用体验，我们建议您及时更新个人信息。这将有助于我们更好地为您提供个性化服务，并确保您收到重要的通知和最新的资讯。</p>

          </div>
        </div>
      </div>
    </div><!-- End Page Header -->

    <!-- ======= Contact Section ======= -->
    <section id="contact" class="contact">
      <div class="container">

        <div class="row justify-content-center mt-4">

          <div class="col-lg-9">
            <div class="php-email-form">
              <div class="row">
                <div class="col-md-6 form-group" style="display: flex; align-items: center;">
                  <label for="username" style="width: 60px">账号：</label><input type="text" name="username" class="form-control" id="username" placeholder="请输入用户名" value="{{.UserAccount.Username}}">
                </div>
                <div class="col-md-6 form-group mt-3 mt-md-0" style="display: flex; align-items: center;">
                  <label for="password" style="width: 60px">密码：</label><input type="password" class="form-control" name="password" id="password" placeholder="请输入密码">
                </div>
              </div>
              <div class="row">
                <div class="col-md-6 form-group" style="display: flex; align-items: center;">
                  <label for="email" style="width: 60px">邮箱：</label><input type="email" name="email" class="form-control" id="email" placeholder="请输入邮箱" value="{{.UserAccount.Email}}">
                </div>
                <div class="col-md-6 form-group mt-3 mt-md-0" style="display: flex; align-items: center;">
                  <label for="phone" style="width: 60px">电话：</label><input type="text" class="form-control" name="phone" id="phone" placeholder="请输入电话" value="{{.UserAccount.Phone}}">
                </div>
              </div>
              <div style="text-align: center;margin-top: 5px;margin-bottom: 2px" id="msg"></div>
              <div class="text-center user-commit"><button type="submit">提交</button></div>
            </div>
          </div><!-- End Contact Form -->

        </div>
        <br>

        <div class="row justify-content-center mt-4">

          <div class="col-lg-9">
            <div class="php-email-form">
              <div class="row">
                <div class="col-md-4 form-group" style="display: flex; align-items: center;">
                  <label for="nickname" style="width: 60px">昵称：</label><input type="text" name="nickname" class="form-control" id="nickname" placeholder="请输入昵称" value="{{.UserInfo.Nickname}}">
                </div>
                <div class="col-md-4 form-group mt-3 mt-md-0" style="display: flex; align-items: center;">
                  <label for="address" style="width: 60px">地址：</label><input type="text" class="form-control" name="address" id="address" placeholder="请输入地址" value="{{.UserInfo.Address}}">
                </div>
                <div class="col-md-4 form-group mt-3 mt-md-0" style="display: flex; align-items: center;">
                  <label for="avatar" style="width: 60px">头像：</label><input type="file" class="form-control" name="avatar" id="avatar" placeholder="请输入头像">
                </div>
              </div>
              <div class="row">
                <div class="col-md-4 form-group" style="display: flex; align-items: center;">
                  <label for="sex" style="width: 60px">性别：</label><input type="text" name="sex" class="form-control" id="sex" placeholder="请输入性别" value="{{.UserInfo.Sex}}">
                </div>
                <div class="col-md-4 form-group mt-3 mt-md-0" style="display: flex; align-items: center;">
                  <label for="age" style="width: 60px">年龄：</label><input type="text" class="form-control" name="age" id="age" placeholder="请输入年龄" value="{{.UserInfo.Age}}">
                </div>
                <div class="col-md-4 form-group mt-3 mt-md-0" style="display: flex; align-items: center;">
                  <label for="brith_date" style="width: 60px">生日：</label><input type="date" class="form-control" name="brith_date" id="brith_date" placeholder="请输入生日">
                </div>
              </div>
              <div class="form-group mt-3" style="display: flex; align-items: center;">
                <label for="bio" style="width: 50px">个人介绍</label><textarea class="form-control" name="bio" rows="5" id="bio" placeholder="请输入个人介绍">{{.UserInfo.Biography}}</textarea>
              </div>
              <div style="text-align: center;margin-top: 5px;margin-bottom: 2px" id="msg1"></div>
              <div class="text-center user-info-commit"><button type="submit">提交</button></div>
            </div>
          </div><!-- End Contact Form -->

        </div>


      </div>
    </section><!-- End Contact Section -->

  </main><!-- End #main -->

  <!-- ======= Footer ======= -->
  <footer id="footer" class="footer">
    <div class="container">
      <div class="copyright">
        &copy; 版权所有 <strong><span>摄影</span></strong>. 保留所有权利
      </div>
      <div class="credits">

      </div>
    </div>
  </footer><!-- End Footer -->

  <a href="#" class="scroll-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

  <div id="preloader">
    <div class="line"></div>
  </div>

  <!-- Vendor JS Files -->
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
  <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
  <script src="assets/vendor/aos/aos.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>

  <!-- Template Main JS File -->
  <script src="assets/js/main.js"></script>
  <script src="/static/assets/js/jquery.min.js"></script>
  <script>
    window.onload = function() {
      let token = window.sessionStorage.getItem('token');
      if (token !== "") {
        document.getElementById('mine').href = "/mine?id=" + token;
        document.getElementById('modify').href = "/modify?id=" + token;
      }
      // 找到登录和注销的链接元素
      const loginLink = document.getElementById('loginLink');
      const logoutLink = document.getElementById('logoutLink');
      if (token) {
        // 如果token存在，则显示注销，隐藏登录
        loginLink.style.display = 'none';
        logoutLink.style.display = 'block';
        // 添加处理注销逻辑的代码
        logoutLink.addEventListener('click', () => {
          window.sessionStorage.removeItem('token');
        });
      } else {
        // 如果token不存在，则显示登录，隐藏注销
        loginLink.style.display = 'block';
        logoutLink.style.display = 'none';
      }
    };
    $(function () {
      // 修改账号信息
      $('.user-commit').click(function () {
        let username = $('#username').val();
        let password = $('#password').val();
        let email = $('#email').val();
        let phone = $('#phone').val();
        let token = window.sessionStorage.getItem('token');
        username = username.trim();
        password = password.trim();
        email = email.trim();
        phone = phone.trim();
        let formData = new FormData();
        formData.append('username', username);
        formData.append('password', password);
        formData.append('email', email);
        formData.append('phone', phone);
        formData.append('id', token);
        $.ajax({
          url: `/account/modify`,
          type: 'post',
          data: formData,
          contentType: false,
          processData: false,
          dataType: 'json',
          success: function (res) {
            const {
              code,
              msg,
              data
            } = res;
              $('#msg').text(msg);
          },
          error: function (error) {
            console.log(error)
          }
        });
      });
      // 修改用户详细信息
      $('.user-info-commit').click(function () {
        let nickname = $('#nickname').val();
        let address = $('#address').val();
        let avatar = $('#avatar')[0].files[0];
        let sex = $('#sex').val();
        let age = $('#age').val();
        let brith_date = $('#brith_date').val();
        let bio = $('#bio').val();
        let token = window.sessionStorage.getItem('token');
        nickname = nickname.trim();
        address = address.trim();
        sex = sex.trim();
        age = age.trim();
        brith_date = brith_date.trim();
        let formData = new FormData();
        formData.append('nickname', nickname);
        formData.append('address', address);
        formData.append('avatar', avatar);
        formData.append('sex', sex);
        formData.append('age', age);
        formData.append('brith_date', brith_date);
        formData.append('bio', bio);
        formData.append('id', token);
        $.ajax({
          url: `/account/modify/information`,
          type: 'post',
          data: formData,
          contentType: false,
          processData: false,
          dataType: 'json',
          success: function (res) {
            const {
              code,
              msg,
              data
            } = res;
            $('#msg1').text(msg);
          },
          error: function (error) {
            console.log(error)
          }
        });
      });
    });
  </script>

</body>

</html>
